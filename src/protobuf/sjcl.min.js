"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),sjcl.cipher.aes=function(t){this.i[0][0][0]||this.B();var e,i,s,c,n=this.i[0][4],r=this.i[1];e=t.length;var o=1;if(4!==e&&6!==e&&8!==e)throw new sjcl.exception.invalid("invalid aes key size");for(this.a=[s=t.slice(0),c=[]],t=e;4*e+28>t;t++)i=s[t-1],(t%e===0||8===e&&t%e===4)&&(i=n[i>>>24]<<24^n[i>>16&255]<<16^n[i>>8&255]<<8^n[255&i],t%e===0&&(i=i<<8^i>>>24^o<<24,o=o<<1^283*(o>>7))),s[t]=s[t-e]^i;for(e=0;t;e++,t--)i=s[3&e?t:t-4],c[e]=4>=t||4>e?i:r[0][n[i>>>24]]^r[1][n[i>>16&255]]^r[2][n[i>>8&255]]^r[3][n[255&i]]},sjcl.cipher.aes.prototype={encrypt:function(t){return this.K(t,0)},decrypt:function(t){return this.K(t,1)},i:[[[],[],[],[],[]],[[],[],[],[],[]]],B:function(){var t,e,i,s,c,n,r,o=this.i[0],a=this.i[1],l=o[4],h=a[4],f=[],d=[];for(t=0;256>t;t++)d[(f[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!l[e];e^=s||1,i=d[i]||1)for(n=i^i<<1^i<<2^i<<3^i<<4,n=n>>8^255&n^99,l[e]=n,h[n]=e,c=f[t=f[s=f[e]]],r=16843009*c^65537*t^257*s^16843008*e,c=257*f[n]^16843008*n,t=0;4>t;t++)o[t][e]=c=c<<24^c>>>8,a[t][n]=r=r<<24^r>>>8;for(t=0;5>t;t++)o[t]=o[t].slice(0),a[t]=a[t].slice(0)},K:function(t,e){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var i=this.a[e],s=t[0]^i[0],c=t[e?3:1]^i[1],n=t[2]^i[2];t=t[e?1:3]^i[3];var r,o,a,l,h=i.length/4-2,f=4,d=[0,0,0,0];r=this.i[e];var u=r[0],p=r[1],m=r[2],g=r[3],j=r[4];for(l=0;h>l;l++)r=u[s>>>24]^p[c>>16&255]^m[n>>8&255]^g[255&t]^i[f],o=u[c>>>24]^p[n>>16&255]^m[t>>8&255]^g[255&s]^i[f+1],a=u[n>>>24]^p[t>>16&255]^m[s>>8&255]^g[255&c]^i[f+2],t=u[t>>>24]^p[s>>16&255]^m[c>>8&255]^g[255&n]^i[f+3],f+=4,s=r,c=o,n=a;for(l=0;4>l;l++)d[e?3&-l:l]=j[s>>>24]<<24^j[c>>16&255]<<16^j[n>>8&255]<<8^j[255&t]^i[f++],r=s,s=c,c=n,n=t,t=r;return d}},sjcl.bitArray={bitSlice:function(t,e,i){return t=sjcl.bitArray.Q(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:sjcl.bitArray.clamp(t,i-e)},extract:function(t,e,i){var s=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-s^t[e/32+1|0]>>>s:t[e/32|0]>>>s)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],s=sjcl.bitArray.getPartial(i);return 32===s?t.concat(e):sjcl.bitArray.Q(e,s,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+sjcl.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var i=t.length;return e&=31,i>0&&e&&(t[i-1]=sjcl.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return!1;var i,s=0;for(i=0;i<t.length;i++)s|=t[i]^e[i];return 0===s},Q:function(t,e,i,s){var c;for(c=0,void 0===s&&(s=[]);e>=32;e-=32)s.push(i),i=0;if(0===e)return s.concat(t);for(c=0;c<t.length;c++)s.push(i|t[c]>>>e),i=t[c]<<32-e;return c=t.length?t[t.length-1]:0,t=sjcl.bitArray.getPartial(c),s.push(sjcl.bitArray.partial(e+t&31,e+t>32?i:s.pop(),1)),s},j:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},sjcl.codec.utf8String={fromBits:function(t){var e,i,s="",c=sjcl.bitArray.bitLength(t);for(e=0;c/8>e;e++)0===(3&e)&&(i=t[e/4]),s+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(s))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],s=0;for(e=0;e<t.length;e++)s=s<<8|t.charCodeAt(e),3===(3&e)&&(i.push(s),s=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),s)),i}},sjcl.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=((0|t[e])+0xf00000000000).toString(16).substr(4);return i.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,s=[];for(t=t.replace(/\s|0x/g,""),i=t.length,t+="00000000",e=0;e<t.length;e+=8)s.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(s,4*i)}},sjcl.codec.base64={H:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var s="",c=0,n=sjcl.codec.base64.H,r=0,o=sjcl.bitArray.bitLength(t);for(i&&(n=n.substr(0,62)+"-_"),i=0;6*s.length<o;)s+=n.charAt((r^t[i]>>>c)>>>26),6>c?(r=t[i]<<6-c,c+=26,i++):(r<<=6,c-=6);for(;3&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,s=[],c=0,n=sjcl.codec.base64.H,r=0;for(e&&(n=n.substr(0,62)+"-_"),e=0;e<t.length;e++){if(i=n.indexOf(t.charAt(e)),0>i)throw new sjcl.exception.invalid("this isn't base64!");c>26?(c-=26,s.push(r^i>>>c),r=i<<32-c):(c+=6,r^=i<<32-c)}return 56&c&&s.push(sjcl.bitArray.partial(56&c,r,1)),s}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.hash.sha256=function(t){this.a[0]||this.B(),t?(this.p=t.p.slice(0),this.k=t.k.slice(0),this.f=t.f):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.p=this.O.slice(0),this.k=[],this.f=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,i=this.k=sjcl.bitArray.concat(this.k,t);for(e=this.f,t=this.f=e+sjcl.bitArray.bitLength(t),e=512+e&-512;t>=e;e+=512)this.G(i.splice(0,16));return this},finalize:function(){var t,e=this.k,i=this.p;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.f/4294967296)),e.push(0|this.f);e.length;)this.G(e.splice(0,16));return this.reset(),i},O:[],a:[],B:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,i=0,s=2;t:for(;64>i;s++){for(e=2;s>=e*e;e++)if(s%e===0)continue t;8>i&&(this.O[i]=t(Math.pow(s,.5))),this.a[i]=t(Math.pow(s,1/3)),i++}},G:function(t){var e,i,s=t.slice(0),c=this.p,n=this.a,r=c[0],o=c[1],a=c[2],l=c[3],h=c[4],f=c[5],d=c[6],u=c[7];for(t=0;64>t;t++)16>t?e=s[t]:(e=s[t+1&15],i=s[t+14&15],e=s[15&t]=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[15&t]+s[t+9&15]|0),e=e+u+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(d^h&(f^d))+n[t],u=d,d=f,f=h,h=l+e|0,l=a,a=o,o=r,r=e+(o&a^l&(o^a))+(o>>>2^o>>>13^o>>>22^o<<30^o<<19^o<<10)|0;c[0]=c[0]+r|0,c[1]=c[1]+o|0,c[2]=c[2]+a|0,c[3]=c[3]+l|0,c[4]=c[4]+h|0,c[5]=c[5]+f|0,c[6]=c[6]+d|0,c[7]=c[7]+u|0}},sjcl.mode.ccm={name:"ccm",encrypt:function(t,e,i,s,c){var n,r=e.slice(0),o=sjcl.bitArray,a=o.bitLength(i)/8,l=o.bitLength(r)/8;if(c=c||64,s=s||[],7>a)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(n=2;4>n&&l>>>8*n;n++);return 15-a>n&&(n=15-a),i=o.clamp(i,8*(15-n)),e=sjcl.mode.ccm.J(t,e,i,s,c,n),r=sjcl.mode.ccm.l(t,r,i,e,c,n),o.concat(r.data,r.tag)},decrypt:function(t,e,i,s,c){c=c||64,s=s||[];var n=sjcl.bitArray,r=n.bitLength(i)/8,o=n.bitLength(e),a=n.clamp(e,o-c),l=n.bitSlice(e,o-c);if(o=(o-c)/8,7>r)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(e=2;4>e&&o>>>8*e;e++);if(15-r>e&&(e=15-r),i=n.clamp(i,8*(15-e)),a=sjcl.mode.ccm.l(t,a,i,l,c,e),t=sjcl.mode.ccm.J(t,a.data,i,s,c,e),!n.equal(a.tag,t))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return a.data},J:function(t,e,i,s,c,n){var r=[],o=sjcl.bitArray,a=o.j;if(c/=8,c%2||4>c||c>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(s.length>4294967295||e.length>4294967295)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");if(n=[o.partial(8,(s.length?64:0)|c-2<<2|n-1)],n=o.concat(n,i),n[3]|=o.bitLength(e)/8,n=t.encrypt(n),s.length)for(i=o.bitLength(s)/8,65279>=i?r=[o.partial(16,i)]:4294967295>=i&&(r=o.concat([o.partial(16,65534)],[i])),r=o.concat(r,s),s=0;s<r.length;s+=4)n=t.encrypt(a(n,r.slice(s,s+4).concat([0,0,0])));for(s=0;s<e.length;s+=4)n=t.encrypt(a(n,e.slice(s,s+4).concat([0,0,0])));return o.clamp(n,8*c)},l:function(t,e,i,s,c,n){var r,o=sjcl.bitArray;r=o.j;var a=e.length,l=o.bitLength(e);if(i=o.concat([o.partial(8,n-1)],i).concat([0,0,0]).slice(0,4),s=o.bitSlice(r(s,t.encrypt(i)),0,c),!a)return{tag:s,data:[]};for(r=0;a>r;r+=4)i[3]++,c=t.encrypt(i),e[r]^=c[0],e[r+1]^=c[1],e[r+2]^=c[2],e[r+3]^=c[3];return{tag:s,data:o.clamp(e,l)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,s,c,n){if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var r,o=sjcl.mode.ocb2.D,a=sjcl.bitArray,l=a.j,h=[0,0,0,0];i=o(t.encrypt(i));var f,d=[];for(s=s||[],c=c||64,r=0;r+4<e.length;r+=4)f=e.slice(r,r+4),h=l(h,f),d=d.concat(l(i,t.encrypt(l(i,f)))),i=o(i);return f=e.slice(r),e=a.bitLength(f),r=t.encrypt(l(i,[0,0,0,e])),f=a.clamp(l(f.concat([0,0,0]),r),e),h=l(h,l(f.concat([0,0,0]),r)),h=t.encrypt(l(h,l(i,o(i)))),s.length&&(h=l(h,n?s:sjcl.mode.ocb2.pmac(t,s))),d.concat(a.concat(f,a.clamp(h,c)))},decrypt:function(t,e,i,s,c,n){if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("ocb iv must be 128 bits");c=c||64;var r,o,a=sjcl.mode.ocb2.D,l=sjcl.bitArray,h=l.j,f=[0,0,0,0],d=a(t.encrypt(i)),u=sjcl.bitArray.bitLength(e)-c,p=[];for(s=s||[],i=0;u/32>i+4;i+=4)r=h(d,t.decrypt(h(d,e.slice(i,i+4)))),f=h(f,r),p=p.concat(r),d=a(d);if(o=u-32*i,r=t.encrypt(h(d,[0,0,0,o])),r=h(r,l.clamp(e.slice(i),o).concat([0,0,0])),f=h(f,r),f=t.encrypt(h(f,h(d,a(d)))),s.length&&(f=h(f,n?s:sjcl.mode.ocb2.pmac(t,s))),!l.equal(l.clamp(f,c),l.bitSlice(e,u)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return p.concat(l.clamp(r,o))},pmac:function(t,e){var i,s=sjcl.mode.ocb2.D,c=sjcl.bitArray,n=c.j,r=[0,0,0,0],o=t.encrypt([0,0,0,0]);for(o=n(o,s(s(o))),i=0;i+4<e.length;i+=4)o=s(o),r=n(r,t.encrypt(n(o,e.slice(i,i+4))));return e=e.slice(i),c.bitLength(e)<128&&(o=n(o,s(o)),e=c.concat(e,[-2147483648,0,0,0])),r=n(r,e),t.encrypt(n(s(n(o,s(o))),r))},D:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,i,s,c){var n=e.slice(0);return e=sjcl.bitArray,c=c||128,s=s||[],t=sjcl.mode.gcm.l(!0,t,n,s,i,c),e.concat(t.data,t.tag)},decrypt:function(t,e,i,s,c){var n=e.slice(0),r=sjcl.bitArray,o=r.bitLength(n);if(c=c||128,s=s||[],o>=c?(e=r.bitSlice(n,o-c),n=r.bitSlice(n,0,o-c)):(e=n,n=[]),t=sjcl.mode.gcm.l(!1,t,n,s,i,c),!r.equal(t.tag,e))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return t.data},T:function(t,e){var i,s,c,n,r=sjcl.bitArray.j;for(s=[0,0,0,0],c=e.slice(0),e=0;128>e;e++){for((i=0!==(t[Math.floor(e/32)]&1<<31-e%32))&&(s=r(s,c)),n=0!==(1&c[3]),i=3;i>0;i--)c[i]=c[i]>>>1|(1&c[i-1])<<31;c[0]>>>=1,n&&(c[0]^=-520093696)}return s},e:function(t,e,i){var s,c=i.length;for(e=e.slice(0),s=0;c>s;s+=4)e[0]^=4294967295&i[s],e[1]^=4294967295&i[s+1],e[2]^=4294967295&i[s+2],e[3]^=4294967295&i[s+3],e=sjcl.mode.gcm.T(e,t);return e},l:function(t,e,i,s,c,n){var r,o,a,l,h,f,d,u,p=sjcl.bitArray;for(f=i.length,d=p.bitLength(i),u=p.bitLength(s),o=p.bitLength(c),r=e.encrypt([0,0,0,0]),96===o?(c=c.slice(0),c=p.concat(c,[1])):(c=sjcl.mode.gcm.e(r,[0,0,0,0],c),c=sjcl.mode.gcm.e(r,c,[0,0,Math.floor(o/4294967296),4294967295&o])),o=sjcl.mode.gcm.e(r,[0,0,0,0],s),h=c.slice(0),s=o.slice(0),t||(s=sjcl.mode.gcm.e(r,o,i)),l=0;f>l;l+=4)h[3]++,a=e.encrypt(h),i[l]^=a[0],i[l+1]^=a[1],i[l+2]^=a[2],i[l+3]^=a[3];return i=p.clamp(i,d),t&&(s=sjcl.mode.gcm.e(r,o,i)),t=[Math.floor(u/4294967296),4294967295&u,Math.floor(d/4294967296),4294967295&d],s=sjcl.mode.gcm.e(r,s,t),a=e.encrypt(c),s[0]^=a[0],s[1]^=a[1],s[2]^=a[2],s[3]^=a[3],{tag:p.bitSlice(s,0,n),data:i}}},sjcl.misc.hmac=function(t,e){this.N=e=e||sjcl.hash.sha256;var i=[[],[]],s=e.prototype.blockSize/32;for(this.n=[new e,new e],t.length>s&&(t=e.hash(t)),e=0;s>e;e++)i[0][e]=909522486^t[e],i[1][e]=1549556828^t[e];this.n[0].update(i[0]),this.n[1].update(i[1])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){return t=new this.N(this.n[0]).update(t).finalize(),new this.N(this.n[1]).update(t).finalize()},sjcl.misc.pbkdf2=function(t,e,i,s,c){if(i=i||1e3,0>s||0>i)throw sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),c=c||sjcl.misc.hmac,t=new c(t);var n,r,o,a,l=[],h=sjcl.bitArray;for(a=1;32*l.length<(s||1);a++){for(c=n=t.encrypt(h.concat(e,[a])),r=1;i>r;r++)for(n=t.encrypt(n),o=0;o<n.length;o++)c[o]^=n[o];l=l.concat(c)}return s&&(l=h.clamp(l,s)),l},sjcl.random={randomWords:function(t,e){var i=[];e=this.isReady(e);var s;if(0===e)throw new sjcl.exception.notReady("generator isn't seeded");for(2&e&&this.W(!(1&e)),e=0;t>e;e+=4)(e+1)%65536===0&&this.M(),s=this.A(),i.push(s[0],s[1],s[2],s[3]);return this.M(),i.slice(0,t)},setDefaultParanoia:function(t){this.w=t},addEntropy:function(t,e,i){i=i||"user";var s,c,n=(new Date).valueOf(),r=this.s[i],o=this.isReady(),a=0;switch(s=this.I[i],void 0===s&&(s=this.I[i]=this.S++),void 0===r&&(r=this.s[i]=0),this.s[i]=(this.s[i]+1)%this.b.length,typeof t){case"number":void 0===e&&(e=1),this.b[r].update([s,this.z++,1,e,n,1,0|t]);break;case"object":if(i=Object.prototype.toString.call(t),"[object Uint32Array]"===i){for(c=[],i=0;i<t.length;i++)c.push(t[i]);t=c}else for("[object Array]"!==i&&(a=1),i=0;i<t.length&&!a;i++)"number"!=typeof t[i]&&(a=1);if(!a){if(void 0===e)for(i=e=0;i<t.length;i++)for(c=t[i];c>0;)e++,c>>>=1;this.b[r].update([s,this.z++,2,e,n,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this.b[r].update([s,this.z++,3,e,n,t.length]),this.b[r].update(t);break;default:a=1}if(a)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[r]+=e,this.g+=e,0===o&&(0!==this.isReady()&&this.L("seeded",Math.max(this.h,this.g)),this.L("progress",this.getProgress()))},isReady:function(t){return t=this.F[void 0!==t?t:this.w],this.h&&this.h>=t?this.m[0]>80&&(new Date).valueOf()>this.P?3:1:this.g>=t?2:0},getProgress:function(t){return t=this.F[t?t:this.w],this.h>=t?1:this.g>t?1:this.g/t},startCollectors:function(){if(!this.o){if(window.addEventListener)window.addEventListener("load",this.q,!1),window.addEventListener("mousemove",this.r,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this.q),document.attachEvent("onmousemove",this.r)}this.o=!0}},stopCollectors:function(){this.o&&(window.removeEventListener?(window.removeEventListener("load",this.q,!1),window.removeEventListener("mousemove",this.r,!1)):window.detachEvent&&(window.detachEvent("onload",this.q),window.detachEvent("onmousemove",this.r)),this.o=!1)},addEventListener:function(t,e){this.t[t][this.R++]=e},removeEventListener:function(t,e){var i;t=this.t[t];var s=[];for(i in t)t.hasOwnProperty(i)&&t[i]===e&&s.push(i);for(e=0;e<s.length;e++)i=s[e],delete t[i]},b:[new sjcl.hash.sha256],m:[0],C:0,s:{},z:0,I:{},S:0,h:0,g:0,P:0,a:[0,0,0,0,0,0,0,0],d:[0,0,0,0],u:void 0,w:6,o:!1,t:{progress:{},seeded:{}},R:0,F:[0,48,64,96,128,192,256,384,512,768,1024],A:function(){for(var t=0;4>t&&(this.d[t]=this.d[t]+1|0,!this.d[t]);t++);return this.u.encrypt(this.d)},M:function(){this.a=this.A().concat(this.A()),this.u=new sjcl.cipher.aes(this.a)},V:function(t){for(this.a=sjcl.hash.sha256.hash(this.a.concat(t)),this.u=new sjcl.cipher.aes(this.a),t=0;4>t&&(this.d[t]=this.d[t]+1|0,!this.d[t]);t++);},W:function(t){var e,i=[],s=0;for(this.P=i[0]=(new Date).valueOf()+3e4,e=0;16>e;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this.b.length&&(i=i.concat(this.b[e].finalize()),s+=this.m[e],this.m[e]=0,t||!(this.C&1<<e));e++);this.C>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.m.push(0)),this.g-=s,s>this.h&&(this.h=s),this.C++,this.V(i)},r:function(t){sjcl.random.addEntropy([t.x||t.clientX||t.offsetX||0,t.y||t.clientY||t.offsetY||0],2,"mouse")},q:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")},L:function(t,e){var i;t=sjcl.random.t[t];var s=[];for(i in t)t.hasOwnProperty(i)&&s.push(t[i]);for(i=0;i<s.length;i++)s[i](e)}};try{var s=new Uint32Array(32);crypto.getRandomValues(s),sjcl.random.addEntropy(s,1024,"crypto['getRandomValues']")}catch(t){}sjcl.json={defaults:{v:1,iter:1e3,ks:256,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(t,e,i,s){i=i||{},s=s||{};var c,n=sjcl.json,r=n.c({iv:sjcl.random.randomWords(4,0)},n.defaults);if(n.c(r,i),i=r.adata,"string"==typeof r.salt&&(r.salt=sjcl.codec.base64.toBits(r.salt)),"string"==typeof r.iv&&(r.iv=sjcl.codec.base64.toBits(r.iv)),!sjcl.mode[r.mode]||!sjcl.cipher[r.cipher]||"string"==typeof t&&r.iter<=100||64!==r.ts&&96!==r.ts&&128!==r.ts||128!==r.ks&&192!==r.ks&&256!==r.ks||r.iv.length<2||r.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t&&(c=sjcl.misc.cachedPbkdf2(t,r),t=c.key.slice(0,r.ks/32),r.salt=c.salt),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof i&&(i=sjcl.codec.utf8String.toBits(i)),c=new sjcl.cipher[r.cipher](t),n.c(s,r),s.key=t,r.ct=sjcl.mode[r.mode].encrypt(c,e,r.iv,i,r.ts),n.encode(r)},decrypt:function(t,e,i,s){i=i||{},s=s||{};var c=sjcl.json;e=c.c(c.c(c.c({},c.defaults),c.decode(e)),i,!0);var n;if(i=e.adata,"string"==typeof e.salt&&(e.salt=sjcl.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=sjcl.codec.base64.toBits(e.iv)),!sjcl.mode[e.mode]||!sjcl.cipher[e.cipher]||"string"==typeof t&&e.iter<=100||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||e.iv.length<2||e.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t&&(n=sjcl.misc.cachedPbkdf2(t,e),t=n.key.slice(0,e.ks/32),e.salt=n.salt),"string"==typeof i&&(i=sjcl.codec.utf8String.toBits(i)),n=new sjcl.cipher[e.cipher](t),i=sjcl.mode[e.mode].decrypt(n,e.ct,e.iv,i,e.ts),c.c(s,e),s.key=t,sjcl.codec.utf8String.fromBits(i)},encode:function(t){var e,i="{",s="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(i+=s+'"'+e+'":',s=",",typeof t[e]){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");t=t.replace(/^\{|\}$/g,"").split(/,/);var e,i,s={};for(e=0;e<t.length;e++){if(!(i=t[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");s[i[2]]=i[3]?parseInt(i[3],10):i[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(i[4]):unescape(i[4])}return s},c:function(t,e,i){if(void 0===t&&(t={}),void 0===e)return t;var s;for(s in e)if(e.hasOwnProperty(s)){if(i&&void 0!==t[s]&&t[s]!==e[s])throw new sjcl.exception.invalid("required parameter overridden");t[s]=e[s]}return t},Y:function(t,e){var i,s={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(s[i]=t[i]);return s},X:function(t,e){var i,s={};for(i=0;i<e.length;i++)void 0!==t[e[i]]&&(s[e[i]]=t[e[i]]);return s}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.U={},sjcl.misc.cachedPbkdf2=function(t,e){var i,s=sjcl.misc.U;return e=e||{},i=e.iter||1e3,s=s[t]=s[t]||{},i=s[i]=s[i]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)},s=void 0===e.salt?i.firstSalt:e.salt,i[s]=i[s]||sjcl.misc.pbkdf2(t,s,e.iter),{key:i[s].slice(0),salt:s.slice(0)}};